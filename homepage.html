<!DOCTYPE html>
<html>
<head>
    <title>借书圈</title>
    <meta http-equiv="Content-Type" content="text/html" charset="utf-8"/>
    <script type="text/javascript" src="scripts/libs/jquery-1.7.1.js"></script>
    <script type="text/javascript" src="scripts/libs/jquery.template.js"></script>
    <script type="text/javascript" src="scripts/libs/jquery.masonry.min.js"></script>
    <script type="text/javascript" src="scripts/libs/jquery.fancybox-1.3.4.js"></script>

    <script type="text/javascript" src="scripts/libs/douban.js"></script>
    <script type="text/javascript" src="http://www.douban.com/js/api-parser.js?v=1"></script>
    <script type="text/javascript" src="scripts/douban.domain.books.js"></script>
    <script type="text/javascript" src="scripts/douban.books.fetcher.js"></script>
    <script type="text/javascript" src="scripts/douban.books.fav_books.js"></script>
    <script type="text/javascript" src="scripts/douban.books.recent_books.js"></script>
    <script type="text/javascript" src="scripts/douban.books.fetcher.js"></script>
    <script type="text/javascript" src="scripts/douban.contact.mapper.js"></script>

    <script type="text/javascript" src="scripts/header.js"></script>
    <script type="text/javascript" src="scripts/home.js"></script>
    <script type="text/javascript" src="scripts/colleagues.js"></script>
    <script type="text/javascript" src="scripts/search-results.js"></script>
    <script type="text/javascript" src="scripts/douban.book.tags.js"></script>
    <script type="text/javascript" src="scripts/homepage.js"></script>
    <script type="text/javascript" src="scripts/purl.js"></script>

    <link href="styles/ie.css" rel="stylesheet" type="text/css"/>
    <link href="styles/font-awesome.css" rel="stylesheet" type="text/css"/>
    <link href="styles/base.css" rel="stylesheet" type="text/css"/>
    <link href="styles/recent.css" rel="stylesheet" type="text/css"/>
    <link href="styles/colleagues.css" rel="stylesheet" type="text/css"/>
    <link href="styles/search_result.css" rel="stylesheet" type="text/css"/>
    <link href="styles/homepage.css" rel="stylesheet" type="text/css"/>

</head>
<body>
<div class="container">
    <section class="header">
        <ul class="navigate_bar clearfix">
            <li class="logo">
                <div>借书圈</div>
            </li>
            <li class="search">
                <form action="search-result" class="search-form">
                    <input id="search-input" class="search-input" type="text" placeholder="想添/借什么书">
                    <button id="search-button" class="search-button">
                        <i class="icon-search"></i>
                        搜索
                    </button>
                </form>
            </li>
            <li>
                <a id="home" class="nav_tab home selected" href="#">首页</a>
            </li>
            <li>
                <a id="colleagues" class="nav_tab colleague" href="#colleagues_container">同事们</a>
            </li>
            <li>
                <a class="nav_tab my-books" href="#">我的书</a>
            </li>
            <li>
                <a class="nav_tab exit" href="#">退出</a>
            </li>
        </ul>
    </section>
    <section class="main-content">
        <div id="person-info"></div>
        <div id="person-tabs-and-books">
            <div id="person-tag-tabs-container">
                <ul>
                    <li class="person-tag-tab">
                        <a id="all-tag-tab" class="tab tag_tab selected" href="#">
                            <span class="tab">全部</span>
                            <span class="number">302</span>
                        </a>
                    </li>
                    <li class="person-tag-tab">
                        <a id="tech-tag-tab" class="tab tag_tab" href="#">
                            <span class="tab">科技</span>
                            <span class="number">174</span>
                        </a>
                    </li>
                    <li class="person-tag-tab">
                        <a id="manage-tag-tab" class="tab tag_tab" href="#">
                            <span class="tab">管理</span>
                            <span class="number">76</span>
                        </a>
                    </li>
                    <li class="person-tag-tab">
                        <a id="culture-tag-tab" class="tab tag_tab" href="#">
                            <span class="tab">文化</span>
                            <span class="number">48</span>
                        </a>
                    </li>
                    <li class="person-tag-tab">
                        <a id="life-tag-tab" class="tab tag_tab" href="#">
                            <span class="tab">生活</span>
                            <span class="number">79</span>
                        </a>
                    </li>
                    <li class="person-tag-tab">
                        <a id="wenxue-tag-tab" class="tab tag_tab" href="#">
                            <span class="tab">文学</span>
                            <span class="number">88</span>
                        </a>
                    </li>
                    <li class="person-tag-tab">
                        <a id="popular-tag-tab" class="tab tag_tab" href="#">
                            <span class="tab">流行</span>
                            <span class="number">33</span>
                        </a>
                    </li>
                </ul>
            </div>
            <div id="person-books-container"></div>
        </div>
    </section>
</div>

<script id="person-avatar-template" type="text/x-jquery-tmpl">
    <span>
        <img class="avatar" src="${user_avatar}"/>
    </span>
    <span class="name">${user_name}</span>
</script>

<script id="person-book-content-template" type="text/x-jquery-tmpl">
    <div class="book">
        <a target="_blank" href="${my_book_url}">
            <img class="book" src="${image_url}"/>
        </a>
    </div>
</script>

<script type="text/javascript">
    DOUBAN.getUserBasicInfo({
        id:$.url(window.location).param("personid"),
        callback:function (user) {
            var user_basic = new DOUBAN.BOOKS.DOMAIN.USER_BASIC(user.avatar, user.name);
            $("#person-info").append($("#person-avatar-template").tmpl(user_basic));
        }
    });

    DOUBAN.getUserCollection({
        uid : $.url(window.location).param("personid"),
        status : 'read',
        callback : function (books) {
            var books_array = books.collections;
            for (var index=0; index<books_array.length; index++) {
                var book = books_array[index];
                var bookObj = book.book;
                var domainBook = new DOUBAN.BOOKS.DOMAIN.BOOK(null, bookObj);
                $("#person-books-container").append($("#person-book-content-template").tmpl(domainBook));
            }
        }
    });
</script>

</body>
</html>